<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.ssafy.project.model.mapper.AttractionMapper">

	<resultMap type="attractionDto" id="attraction">
		<result column="content_id" property="contentId" />
		<result column="content_type_id" property="contentTypeId" />
		<result column="title" property="title" />
		<result column="addr1" property="addr1" />
		<result column="first_image" property="firstImage" />
	</resultMap>

	<resultMap type="attractionDto" id="viewAttraction"
		extends="attraction">
		<result column="content_id" property="contentId" />
		<result column="title" property="title" />
	</resultMap>

	<sql id="search">
		<trim suffixOverrides="and">
			<if test="searchSidoCode != null and searchSidoCode != -1">sido_code = #{searchSidoCode} and</if>
			<if test="searchContentTypeId != null and searchContentTypeId != -1">content_type_id = #{searchContentTypeId} and</if>
			<if test="searchWord != null">title like concat('%', #{searchWord}, '%') and</if>
		</trim>
	</sql>
	
	<!-- <select id="listArticle" parameterType="map" resultMap="attraction">
		select b.article_no, b.user_id, b.subject, b.content, b.hit,
		b.register_time, m.user_name
		from board b, members m
		where b.user_id =
		m.user_id
		<include refid="search"></include>
		order by b.article_no desc
		limit #{start}, #{listsize}
	</select> -->

	<select id="attractionList" parameterType="map"
		resultMap="attraction">
		select *
		from attraction_info
		<where>
			<include refid="search"></include>
		</where>
		order by content_id asc
		limit #{start}, #{listsize}
	</select>

	<select id="getTotalArticleCount" parameterType="map"
		resultType="int">
		select count(content_id)
		from attraction_info
		<where>
			<include refid="search"></include>
		</where>
	</select>

	<select id="getAttraction" parameterType="int"
		resultMap="attraction">
		select *
		from attraction_info
		where content_id = #{contentId}
	</select>
</mapper>